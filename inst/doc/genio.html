<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Alejandro Ochoa" />

<meta name="date" content="2019-05-28" />

<title>Read and write BED files with genio</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Read and write BED files with <code>genio</code></h1>
<h4 class="author">Alejandro Ochoa</h4>
<h4 class="date">2019-05-28</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>genio</code> (GenIO = Genetics I/O) package aims to facilitate reading and writing genetics data. The focus of this vignette is processing plink BED/BIM/FAM files.</p>
<p>There are some limited alternatives for reading and/or writing BED files in R, which are slower and harder to use, which motivated me to write this package. Here we make direct comparisons to those packages, to illustrate the advantages of <code>genio</code>.</p>
</div>
<div id="generate-a-large-matrix-of-random-genotypes" class="section level1">
<h1>Generate a large matrix of random genotypes</h1>
<p>Let’s begin by creating a large genotype matrix with completely random data, and with missing values so this becomes non-trivial to read and write.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Data dimensions.</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># Choose non-multiples of 4 to test edge cases of BED parsers.</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># Number of loci.</span></a>
<a class="sourceLine" id="cb1-4" title="4">m_loci &lt;-<span class="st"> </span><span class="dv">10001</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># Number of individuals</span></a>
<a class="sourceLine" id="cb1-6" title="6">n_ind &lt;-<span class="st"> </span><span class="dv">1001</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co"># Overall allele frequency</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># (we don&#39;t do any actual genetics in this vignette,</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co"># so just set to a reasonable value)</span></a>
<a class="sourceLine" id="cb1-10" title="10">p &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># Missingness rate</span></a>
<a class="sourceLine" id="cb1-12" title="12">miss &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co"># Total number of genotypes</span></a>
<a class="sourceLine" id="cb1-15" title="15">n_data &lt;-<span class="st"> </span>n_ind <span class="op">*</span><span class="st"> </span>m_loci</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co"># Draw random genotypes from Binomial</span></a>
<a class="sourceLine" id="cb1-17" title="17">X &lt;-<span class="st"> </span><span class="kw">rbinom</span>( n_data, <span class="dv">2</span>, p)</a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># Add missing values</span></a>
<a class="sourceLine" id="cb1-19" title="19">X[ <span class="kw">sample</span>(n_data, n_data <span class="op">*</span><span class="st"> </span>miss) ] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co"># Turn into matrix</span></a>
<a class="sourceLine" id="cb1-21" title="21">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(X, <span class="dt">nrow =</span> m_loci, <span class="dt">ncol =</span> n_ind)</a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co"># Inspect the first 10 individuals at the first 10 loci</span></a>
<a class="sourceLine" id="cb1-24" title="24">X[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt;  [1,]    0    2    1    2    1    2    2    0    1     1</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#&gt;  [2,]   NA    1    2    2    1    2   NA    2   NA     2</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">#&gt;  [3,]    2   NA    2    1    1   NA    1    1    1     2</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">#&gt;  [4,]    0    2   NA    1    2    2    1    1   NA     0</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="co">#&gt;  [5,]   NA    0    1    2    2    1    1    1   NA     2</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co">#&gt;  [6,]    2    2    0    1    1    1    2    0    0     1</span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">#&gt;  [7,]    1   NA    1    1   NA    2    2    2    1     2</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">#&gt;  [8,]    1    0   NA    2    0    0    0    1    1     0</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">#&gt;  [9,]    1   NA    0    1    1    1   NA   NA   NA     2</span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="co">#&gt; [10,]    1    1    1    1    2    1    1    2    1     1</span></a></code></pre></div>
<p>To create annotation tables that look a bit more interesting than the defaults, let us create some slightly more realistic values. Here we use our first <code>genio</code> function!</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(genio)</a></code></pre></div>
<p>First we create and edit the locus annotations table.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># We have to specify the number of loci</span></a>
<a class="sourceLine" id="cb3-2" title="2">bim &lt;-<span class="st"> </span><span class="kw">make_bim</span>( <span class="dt">n =</span> m_loci )</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Inspect the default values</span></a>
<a class="sourceLine" id="cb3-5" title="5">bim</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; # A tibble: 10,001 x 6</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt;      chr    id  posg   pos   ref   alt</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;    &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt;  1     1     1     0     1     1     2</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;  2     1     2     0     2     1     2</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;  3     1     3     0     3     1     2</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;  4     1     4     0     4     1     2</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;  5     1     5     0     5     1     2</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;  6     1     6     0     6     1     2</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;  7     1     7     0     7     1     2</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;  8     1     8     0     8     1     2</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;  9     1     9     0     9     1     2</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; 10     1    10     0    10     1     2</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; # … with 9,991 more rows</span></a>
<a class="sourceLine" id="cb3-20" title="20"></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co"># Let&#39;s add the &quot;chr&quot; prefix to the chromosome values,</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co"># so we recognize them when we see them later.</span></a>
<a class="sourceLine" id="cb3-23" title="23">bim<span class="op">$</span>chr &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;chr&#39;</span>, bim<span class="op">$</span>chr)</a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co"># Make SNP IDs look like &quot;rs&quot; IDs</span></a>
<a class="sourceLine" id="cb3-25" title="25">bim<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;rs&#39;</span>, bim<span class="op">$</span>id)</a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co"># Make positions 1000 bigger</span></a>
<a class="sourceLine" id="cb3-27" title="27">bim<span class="op">$</span>pos &lt;-<span class="st"> </span>bim<span class="op">$</span>pos <span class="op">*</span><span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co"># Select randomly between Cs and Gs for the reference alleles</span></a>
<a class="sourceLine" id="cb3-29" title="29">bim<span class="op">$</span>ref &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&#39;C&#39;</span>, <span class="st">&#39;G&#39;</span>), m_loci, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co"># Select randomly between As and Ts for the alternative alleles</span></a>
<a class="sourceLine" id="cb3-31" title="31">bim<span class="op">$</span>alt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;T&#39;</span>), m_loci, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-32" title="32"></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co"># Inspect the table with our changes</span></a>
<a class="sourceLine" id="cb3-34" title="34">bim</a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt; # A tibble: 10,001 x 6</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt;    chr   id     posg   pos ref   alt  </span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt;  1 chr1  rs1       0  1000 G     A    </span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt;  2 chr1  rs2       0  2000 G     A    </span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt;  3 chr1  rs3       0  3000 C     T    </span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt;  4 chr1  rs4       0  4000 G     T    </span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt;  5 chr1  rs5       0  5000 G     T    </span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#&gt;  6 chr1  rs6       0  6000 G     A    </span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co">#&gt;  7 chr1  rs7       0  7000 G     A    </span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt;  8 chr1  rs8       0  8000 G     A    </span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#&gt;  9 chr1  rs9       0  9000 C     A    </span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#&gt; 10 chr1  rs10      0 10000 C     A    </span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co">#&gt; # … with 9,991 more rows</span></a></code></pre></div>
<p>Now we similarly create and edit the individual annotations table.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Specify the number of individuals</span></a>
<a class="sourceLine" id="cb4-2" title="2">fam &lt;-<span class="st"> </span><span class="kw">make_fam</span>( <span class="dt">n =</span> n_ind )</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># Inspect the default values</span></a>
<a class="sourceLine" id="cb4-5" title="5">fam</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; # A tibble: 1,001 x 6</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt;      fam    id   pat   mat   sex pheno</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;  1     1     1     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt;  2     2     2     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;  3     3     3     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;  4     4     4     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt;  5     5     5     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt;  6     6     6     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt;  7     7     7     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt;  8     8     8     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt;  9     9     9     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; 10    10    10     0     0     0     0</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; # … with 991 more rows</span></a>
<a class="sourceLine" id="cb4-20" title="20"></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co"># Add prefixes to families and IDs to recognize them later</span></a>
<a class="sourceLine" id="cb4-22" title="22">fam<span class="op">$</span>fam &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;fam&#39;</span>, fam<span class="op">$</span>fam)</a>
<a class="sourceLine" id="cb4-23" title="23">fam<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;id&#39;</span>, fam<span class="op">$</span>id)</a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co"># Sex values are usually 1 and 2</span></a>
<a class="sourceLine" id="cb4-25" title="25">fam<span class="op">$</span>sex &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, n_ind, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co"># Let&#39;s make phenotypes continuous.</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co"># Draw independently from Standard Normal.</span></a>
<a class="sourceLine" id="cb4-28" title="28">fam<span class="op">$</span>pheno &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n_ind)</a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co"># Let&#39;s leave maternal and paternal IDs as missing</span></a>
<a class="sourceLine" id="cb4-30" title="30"></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co"># Inspect again</span></a>
<a class="sourceLine" id="cb4-32" title="32">fam</a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt; # A tibble: 1,001 x 6</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt;    fam   id      pat   mat   sex   pheno</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">#&gt;  1 fam1  id1       0     0     1 -1.32  </span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#&gt;  2 fam2  id2       0     0     1 -0.407 </span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#&gt;  3 fam3  id3       0     0     1  1.43  </span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt;  4 fam4  id4       0     0     1 -0.637 </span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt;  5 fam5  id5       0     0     1 -0.501 </span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt;  6 fam6  id6       0     0     2 -1.45  </span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co">#&gt;  7 fam7  id7       0     0     2 -0.830 </span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co">#&gt;  8 fam8  id8       0     0     2  0.120 </span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">#&gt;  9 fam9  id9       0     0     2  1.55  </span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">#&gt; 10 fam10 id10      0     0     1 -0.0726</span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">#&gt; # … with 991 more rows</span></a></code></pre></div>
<p>Lastly, let’s copy the locus and individual IDs as row and column names of the genotype matrix, respectively. Although this step is not required, it is encouraged for consistency (if present, values are checked when writing files).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># Add column and row names from bim and fam tables we just created.</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">rownames</span>(X) &lt;-<span class="st"> </span>bim<span class="op">$</span>id</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span>fam<span class="op">$</span>id</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># Inspect again the first 10 individuals and loci</span></a>
<a class="sourceLine" id="cb5-5" title="5">X[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt;      id1 id2 id3 id4 id5 id6 id7 id8 id9 id10</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; rs1    0   2   1   2   1   2   2   0   1    1</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; rs2   NA   1   2   2   1   2  NA   2  NA    2</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; rs3    2  NA   2   1   1  NA   1   1   1    2</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; rs4    0   2  NA   1   2   2   1   1  NA    0</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; rs5   NA   0   1   2   2   1   1   1  NA    2</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; rs6    2   2   0   1   1   1   2   0   0    1</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; rs7    1  NA   1   1  NA   2   2   2   1    2</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; rs8    1   0  NA   2   0   0   0   1   1    0</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; rs9    1  NA   0   1   1   1  NA  NA  NA    2</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; rs10   1   1   1   1   2   1   1   2   1    1</span></a></code></pre></div>
</div>
<div id="write-genotypes-to-plink-files" class="section level1">
<h1>Write genotypes to plink files</h1>
<p>Let’s write this random data to a file. This mode is intended for simulated data, generating dummy BIM and FAM files in the process and writing out all three.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Will delete at the end of the vignette</span></a>
<a class="sourceLine" id="cb6-2" title="2">file_plink &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="st">&#39;vignette-random-data&#39;</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co"># Write genotypes, along with the BIM and FAM files we created.</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co"># Omiting them would result in writing the original dummy version of these tables,</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co"># before we edited them.</span></a>
<a class="sourceLine" id="cb6-7" title="7">time_write_genio &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb6-8" title="8">    <span class="kw">write_plink</span>(file_plink, X, bim, fam)</a>
<a class="sourceLine" id="cb6-9" title="9">)</a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; Writing: /tmp/Rtmp6m33wC/vignette-random-data75005ff8a4f3.bed</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; Writing: /tmp/Rtmp6m33wC/vignette-random-data75005ff8a4f3.fam</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; Writing: /tmp/Rtmp6m33wC/vignette-random-data75005ff8a4f3.bim</span></a>
<a class="sourceLine" id="cb6-13" title="13">time_write_genio</a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt;   0.140   0.001   0.141</span></a></code></pre></div>
</div>
<div id="read-back-the-genotypes" class="section level1">
<h1>Read back the genotypes</h1>
<p>Here we demonstrate how easy it is to read the data back. To compare to other packages, we shall time loading all this data.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Read the data back in memory.</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># Time this step</span></a>
<a class="sourceLine" id="cb7-3" title="3">time_read_genio &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb7-4" title="4">    data_genio &lt;-<span class="st"> </span><span class="kw">read_plink</span>(file_plink)</a>
<a class="sourceLine" id="cb7-5" title="5">)</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; Reading: /tmp/Rtmp6m33wC/vignette-random-data75005ff8a4f3.bim</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; Reading: /tmp/Rtmp6m33wC/vignette-random-data75005ff8a4f3.fam</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; Reading: /tmp/Rtmp6m33wC/vignette-random-data75005ff8a4f3.bed</span></a>
<a class="sourceLine" id="cb7-9" title="9">time_read_genio</a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt;   0.106   0.051   0.158</span></a>
<a class="sourceLine" id="cb7-12" title="12"></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co"># Inspect the data we just read back</span></a>
<a class="sourceLine" id="cb7-14" title="14"></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co"># The same random genotypes (first 10 individuals and loci, now with row and column names):</span></a>
<a class="sourceLine" id="cb7-16" title="16">data_genio<span class="op">$</span>X[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt;      id1 id2 id3 id4 id5 id6 id7 id8 id9 id10</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; rs1    0   2   1   2   1   2   2   0   1    1</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; rs2   NA   1   2   2   1   2  NA   2  NA    2</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; rs3    2  NA   2   1   1  NA   1   1   1    2</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; rs4    0   2  NA   1   2   2   1   1  NA    0</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; rs5   NA   0   1   2   2   1   1   1  NA    2</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; rs6    2   2   0   1   1   1   2   0   0    1</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt; rs7    1  NA   1   1  NA   2   2   2   1    2</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; rs8    1   0  NA   2   0   0   0   1   1    0</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt; rs9    1  NA   0   1   1   1  NA  NA  NA    2</span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt; rs10   1   1   1   1   2   1   1   2   1    1</span></a>
<a class="sourceLine" id="cb7-28" title="28"></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co"># The locus annotations</span></a>
<a class="sourceLine" id="cb7-30" title="30">data_genio<span class="op">$</span>bim</a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt; # A tibble: 10,001 x 6</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt;    chr   id     posg   pos ref   alt  </span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt;  1 chr1  rs1       0  1000 G     A    </span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt;  2 chr1  rs2       0  2000 G     A    </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt;  3 chr1  rs3       0  3000 C     T    </span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt;  4 chr1  rs4       0  4000 G     T    </span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt;  5 chr1  rs5       0  5000 G     T    </span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt;  6 chr1  rs6       0  6000 G     A    </span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt;  7 chr1  rs7       0  7000 G     A    </span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt;  8 chr1  rs8       0  8000 G     A    </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt;  9 chr1  rs9       0  9000 C     A    </span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt; 10 chr1  rs10      0 10000 C     A    </span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt; # … with 9,991 more rows</span></a>
<a class="sourceLine" id="cb7-45" title="45"></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co"># The individual annotations</span></a>
<a class="sourceLine" id="cb7-47" title="47">data_genio<span class="op">$</span>fam</a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">#&gt; # A tibble: 1,001 x 6</span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">#&gt;    fam   id    pat   mat     sex   pheno</span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">#&gt;  1 fam1  id1   0     0         1 -1.32  </span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">#&gt;  2 fam2  id2   0     0         1 -0.407 </span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="co">#&gt;  3 fam3  id3   0     0         1  1.43  </span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">#&gt;  4 fam4  id4   0     0         1 -0.637 </span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">#&gt;  5 fam5  id5   0     0         1 -0.501 </span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="co">#&gt;  6 fam6  id6   0     0         2 -1.45  </span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co">#&gt;  7 fam7  id7   0     0         2 -0.830 </span></a>
<a class="sourceLine" id="cb7-58" title="58"><span class="co">#&gt;  8 fam8  id8   0     0         2  0.120 </span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="co">#&gt;  9 fam9  id9   0     0         2  1.55  </span></a>
<a class="sourceLine" id="cb7-60" title="60"><span class="co">#&gt; 10 fam10 id10  0     0         1 -0.0726</span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="co">#&gt; # … with 991 more rows</span></a>
<a class="sourceLine" id="cb7-62" title="62"></a>
<a class="sourceLine" id="cb7-63" title="63"><span class="co"># Quickly test that the inputs and outputs are identical.</span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="co"># Genotypes have NAs, so we have to compare this way.</span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="kw">stopifnot</span>( <span class="kw">all</span>( X <span class="op">==</span><span class="st"> </span>data_genio<span class="op">$</span>X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) )</a>
<a class="sourceLine" id="cb7-66" title="66"><span class="kw">stopifnot</span>( bim <span class="op">==</span><span class="st"> </span>data_genio<span class="op">$</span>bim )</a>
<a class="sourceLine" id="cb7-67" title="67"><span class="co"># FAM has mixed content (chars, ints, and doubles).</span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="co"># First 5 columns should be exact match:</span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="kw">stopifnot</span>( fam[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">==</span><span class="st"> </span>data_genio<span class="op">$</span>fam[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] )</a>
<a class="sourceLine" id="cb7-70" title="70"><span class="co"># Exact equality may fail for pheno due to precisions, so test this way instead:</span></a>
<a class="sourceLine" id="cb7-71" title="71"><span class="kw">stopifnot</span>( <span class="kw">max</span>(<span class="kw">abs</span>(fam<span class="op">$</span>pheno <span class="op">-</span><span class="st"> </span>data_genio<span class="op">$</span>fam<span class="op">$</span>pheno)) <span class="op">&lt;</span><span class="st"> </span><span class="fl">1e-4</span> )</a></code></pre></div>
</div>
<div id="memory-estimation" class="section level1">
<h1>Memory estimation</h1>
<p>One drawback of <code>genio</code> and other related approaches is high memory consumption (see more on that at the end of this vignette). It is entirely possible that an attempt to parse a genotype matrix into memory will fail with an “out of memory” error message. Let’s estimate memory usage here.</p>
<p>Genotypes are stored as integers by <code>genio</code>, which in R on a modern machine (64 bit architecture) consumes 4 bytes! So an <span class="math inline">\(n \times m\)</span> matrix takes up at least <span class="math inline">\(4 n m\)</span> bytes (an R matrix contains an additional constant overhead, which does not depend on <span class="math inline">\(n,m\)</span> and is relatively small for large matrices).</p>
<p>To get an idea of how much this is, let’s assume a standard genotyping array, where <span class="math inline">\(m\)</span> is about half a million. In this scenario, we get a simple rule of thumb that every 1000 individuals consume a little less than 2G:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Constants</span></a>
<a class="sourceLine" id="cb8-2" title="2">bytes_per_genotype &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb8-3" title="3">bytes_per_gb &lt;-<span class="st"> </span><span class="dv">1024</span> <span class="op">^</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co"># Example data dimensions</span></a>
<a class="sourceLine" id="cb8-5" title="5">num_ind &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb8-6" title="6">num_loci &lt;-<span class="st"> </span><span class="dv">500000</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co"># Gigabytes per 1000 individuals for a typical genotyping array</span></a>
<a class="sourceLine" id="cb8-8" title="8">bytes_per_genotype <span class="op">*</span><span class="st"> </span>num_ind <span class="op">*</span><span class="st"> </span>num_loci <span class="op">/</span><span class="st"> </span>bytes_per_gb</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; [1] 1.862645</span></a></code></pre></div>
<p>This is the amount of free memory required just to load the matrix. Several common matrix operations for genotypes consume even more memory, so more free memory will be needed to accomplish anything.</p>
</div>
<div id="comparison-to-other-packages" class="section level1">
<h1>Comparison to other packages</h1>
<p>There are several R packages that provide BED readers, and to a lesser extent some of the other functionality of <code>genio</code>. Here we compare directly to <code>BEDMatrix</code>, <code>snpStats</code>, and <code>lfa</code>. Each of these packages has different goals so they are optimized for their use cases. The <code>genio</code> parser is optimized to read the entire genotype data into a native R matrix, so that it is easy to inspect and manipulate for R beginners. Here we demonstrate that <code>genio</code> is not only the fastest at this task, but also the easiest to obtain in terms of requiring the least amount of coding.</p>
<div id="bedmatrix" class="section level2">
<h2>BEDMatrix</h2>
<p>The <code>BEDMatrix</code> package allows access to genotypes from a BED file without loading the entire matrix in memory. This is very convenient for large datasets, as long as only small portions of the data are pulled at once. However, there are some disadvantages:</p>
<ul>
<li>The <code>BEDMatrix</code> return object is not a regular R matrix, which confuses some users.</li>
<li>The <code>BEDMatrix</code> package provides no way to access the full annotation tables (BIM and FAM files).
<ul>
<li>From BIM, only the locus ID and reference allele are returned, merged into a vector of strings and placed as column names.</li>
<li>From FAM, only the family and individual IDs are returned, merged into a vector of strings and placed as row names.</li>
</ul></li>
<li><code>BEDMatrix</code> does not have any write functions.</li>
</ul>
<p>Here is an example of that usage and how the data compares. Note in particular that the <code>BEDMatrix</code> representation of the genotype matrix is transposed compared to the <code>genio</code> matrix:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">library</span>(BEDMatrix)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># Time it too.</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co"># Although the BIM and FAM tables are not returned,</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co"># they are partially parsed and kept in memory,</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co"># which can take time for extremely large files</span></a>
<a class="sourceLine" id="cb9-6" title="6">time_read_bedmatrix_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb9-7" title="7">    X_BEDMatrix &lt;-<span class="st"> </span><span class="kw">BEDMatrix</span>(file_plink)</a>
<a class="sourceLine" id="cb9-8" title="8">)</a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; Extracting number of samples and rownames from vignette-random-data75005ff8a4f3.fam...</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; Extracting number of variants and colnames from vignette-random-data75005ff8a4f3.bim...</span></a>
<a class="sourceLine" id="cb9-11" title="11"></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co"># Inspect the first 10 loci and individuals as usual.</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co"># Note it is transposed compared to our X.</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co"># Also note the column and row names are different from genio&#39;s.</span></a>
<a class="sourceLine" id="cb9-15" title="15">X_BEDMatrix[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt;            rs1_G rs2_G rs3_C rs4_G rs5_G rs6_G rs7_G rs8_G rs9_C rs10_C</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; fam1_id1       0    NA     2     0    NA     2     1     1     1      1</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; fam2_id2       2     1    NA     2     0     2    NA     0    NA      1</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; fam3_id3       1     2     2    NA     1     0     1    NA     0      1</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; fam4_id4       2     2     1     1     2     1     1     2     1      1</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; fam5_id5       1     1     1     2     2     1    NA     0     1      2</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; fam6_id6       2     2    NA     2     1     1     2     0     1      1</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; fam7_id7       2    NA     1     1     1     2     2     0    NA      1</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; fam8_id8       0     2     1     1     1     0     2     1    NA      2</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; fam9_id9       1    NA     1    NA    NA     0     1     1    NA      1</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#&gt; fam10_id10     1     2     2     0     2     1     2     0     2      1</span></a></code></pre></div>
<p>Therefore, for very large datasets, if it suffices to access the genotype data in small portions and the user is willing to deal with the limitations of the object, and no detailed annotation table information is required, then <code>BEDMatrix</code> is a better solution than the <code>read_bed</code> function provided in the <code>genio</code> package.</p>
<p>To compare the two genotype reading functions on an equal footing, let us assume that the entire genotype matrix is required in memory and stored in a regular R matrix.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># This turns it into a regular R matrix.</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># Since most of the reading is actually happening now,</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co"># we time this step now.</span></a>
<a class="sourceLine" id="cb10-4" title="4">time_read_bedmatrix_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb10-5" title="5">    X_BEDMatrix_Rmat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X_BEDMatrix)</a>
<a class="sourceLine" id="cb10-6" title="6">)</a>
<a class="sourceLine" id="cb10-7" title="7">time_read_bedmatrix_<span class="dv">2</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;   0.076   0.007   0.083</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co"># Now we can test that the BEDMatrix agrees with the original matrix we simulated.</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co"># Need to transpose first.</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">stopifnot</span>( <span class="kw">all</span>( X <span class="op">==</span><span class="st"> </span><span class="kw">t</span>(X_BEDMatrix_Rmat), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) )</a></code></pre></div>
</div>
<div id="snpstats" class="section level2">
<h2>snpStats</h2>
<p>The <code>snpStats</code> package is the most fully-featured alternative to <code>genio</code>. One of its advantages is its memory efficiency, encoding the entire data in less memory than a native R matrix. However, this memory efficiency comes at the cost of making the data harder to access, especially for inexperienced R users. Like <code>genio</code>, and in contrast to the other packages, <code>snpStats</code> also reads the BIM and FAM tables fully, and provides a BED writer, but it is considerably harder to use.</p>
<p>First we illustrate data parsing. The annotation tables are similar but column names are different, and certain missing values (zero in text files) are converted to <code>NA</code> instead.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">library</span>(snpStats)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&gt; Loading required package: survival</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co"># Read data, time it.</span></a>
<a class="sourceLine" id="cb11-6" title="6">time_read_snpStats_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb11-7" title="7">    data_snpStats &lt;-<span class="st"> </span><span class="kw">read.plink</span>(file_plink)</a>
<a class="sourceLine" id="cb11-8" title="8">)</a>
<a class="sourceLine" id="cb11-9" title="9">time_read_snpStats_<span class="dv">1</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt;   0.032   0.002   0.034</span></a>
<a class="sourceLine" id="cb11-12" title="12"></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co"># Inspect the data</span></a>
<a class="sourceLine" id="cb11-14" title="14"></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co"># Genotypes.</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co"># Note data is not visualized this way.</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co"># This matrix is also transposed compared to the genio matrix.</span></a>
<a class="sourceLine" id="cb11-18" title="18">data_snpStats<span class="op">$</span>genotypes</a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#&gt; A SnpMatrix with  1001 rows and  10001 columns</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="co">#&gt; Row names:  fam1 ... fam1001 </span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">#&gt; Col names:  rs1 ... rs10001</span></a>
<a class="sourceLine" id="cb11-22" title="22"></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="co"># Locus annotations</span></a>
<a class="sourceLine" id="cb11-24" title="24"><span class="kw">head</span>( data_snpStats<span class="op">$</span>map )</a>
<a class="sourceLine" id="cb11-25" title="25"><span class="co">#&gt;     chromosome snp.name cM position allele.1 allele.2</span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co">#&gt; rs1       chr1      rs1 NA     1000        G        A</span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="co">#&gt; rs2       chr1      rs2 NA     2000        G        A</span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="co">#&gt; rs3       chr1      rs3 NA     3000        C        T</span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="co">#&gt; rs4       chr1      rs4 NA     4000        G        T</span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="co">#&gt; rs5       chr1      rs5 NA     5000        G        T</span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="co">#&gt; rs6       chr1      rs6 NA     6000        G        A</span></a>
<a class="sourceLine" id="cb11-32" title="32"></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co"># Individual annotations</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="kw">head</span> (data_snpStats<span class="op">$</span>fam )</a>
<a class="sourceLine" id="cb11-35" title="35"><span class="co">#&gt;      pedigree member father mother sex   affected</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="co">#&gt; fam1     fam1    id1     NA     NA   1 -1.3178785</span></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="co">#&gt; fam2     fam2    id2     NA     NA   1 -0.4069814</span></a>
<a class="sourceLine" id="cb11-38" title="38"><span class="co">#&gt; fam3     fam3    id3     NA     NA   1  1.4285570</span></a>
<a class="sourceLine" id="cb11-39" title="39"><span class="co">#&gt; fam4     fam4    id4     NA     NA   1 -0.6372474</span></a>
<a class="sourceLine" id="cb11-40" title="40"><span class="co">#&gt; fam5     fam5    id5     NA     NA   1 -0.5013365</span></a>
<a class="sourceLine" id="cb11-41" title="41"><span class="co">#&gt; fam6     fam6    id6     NA     NA   2 -1.4494673</span></a></code></pre></div>
<p>As for <code>BEDMatrix</code>, assuming we ultimately desire to convert the entire data into a regular R matrix, an extra step is required:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Transpose, then convert to a regular R matrix.</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co"># Let&#39;s time this step too.</span></a>
<a class="sourceLine" id="cb12-3" title="3">time_read_snpStats_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb12-4" title="4">    X_snpStats &lt;-<span class="st"> </span><span class="kw">as</span>( <span class="kw">t</span>(data_snpStats<span class="op">$</span>genotypes), <span class="st">&#39;numeric&#39;</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">)</a>
<a class="sourceLine" id="cb12-6" title="6">time_read_snpStats_<span class="dv">2</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt;   0.069   0.017   0.086</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co"># Now we can visualize the matrix.</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co"># First 10 loci and individuals, as before.</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co"># Note that, compared to (genio, BEDMatrix, lfa), alleles are encoded in reverse,</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co"># so 0s and 2s are flipped in this matrix.</span></a>
<a class="sourceLine" id="cb12-14" title="14">X_snpStats[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt;      fam1 fam2 fam3 fam4 fam5 fam6 fam7 fam8 fam9 fam10</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt; rs1     2    0    1    0    1    0    0    2    1     1</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">#&gt; rs2    NA    1    0    0    1    0   NA    0   NA     0</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co">#&gt; rs3     0   NA    0    1    1   NA    1    1    1     0</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="co">#&gt; rs4     2    0   NA    1    0    0    1    1   NA     2</span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="co">#&gt; rs5    NA    2    1    0    0    1    1    1   NA     0</span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="co">#&gt; rs6     0    0    2    1    1    1    0    2    2     1</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="co">#&gt; rs7     1   NA    1    1   NA    0    0    0    1     0</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="co">#&gt; rs8     1    2   NA    0    2    2    2    1    1     2</span></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="co">#&gt; rs9     1   NA    2    1    1    1   NA   NA   NA     0</span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="co">#&gt; rs10    1    1    1    1    0    1    1    0    1     1</span></a>
<a class="sourceLine" id="cb12-26" title="26"></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="co"># Again verify that the matrices are identical.</span></a>
<a class="sourceLine" id="cb12-28" title="28"><span class="co"># (Here 2-X flips back 0s and 2s)</span></a>
<a class="sourceLine" id="cb12-29" title="29"><span class="kw">stopifnot</span>( <span class="kw">all</span>( X <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>X_snpStats, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) )</a></code></pre></div>
<p><code>snpStats</code> is the only package other than <code>genio</code> to provide a BED writer. Here we demonstrate how hard it is to use it to write our data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Let&#39;s write this to another file</span></a>
<a class="sourceLine" id="cb13-2" title="2">file_plink_copy &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="st">&#39;vignette-random-data-copy&#39;</span>)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co"># Copy objects to not change originals</span></a>
<a class="sourceLine" id="cb13-5" title="5">X_snpStats &lt;-<span class="st"> </span>X</a>
<a class="sourceLine" id="cb13-6" title="6">bim_snpStats &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(bim) <span class="co"># to use rownames</span></a>
<a class="sourceLine" id="cb13-7" title="7">fam_snpStats &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(fam) <span class="co"># ditto</span></a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co"># All data requires matching row and/or column names.</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co"># These first two were already done above.</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">#rownames(X_snpStats) &lt;- bim$id</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">#colnames(X_snpStats) &lt;- fam$id</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co"># Row names here are redundant but required.</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="kw">rownames</span>(bim_snpStats) &lt;-<span class="st"> </span>bim<span class="op">$</span>id</a>
<a class="sourceLine" id="cb13-15" title="15"><span class="kw">rownames</span>(fam_snpStats) &lt;-<span class="st"> </span>fam<span class="op">$</span>id</a>
<a class="sourceLine" id="cb13-16" title="16"></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co"># We shall time several required steps in order to write genotypes in a standard R matrix,</span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co"># and the related annotation tables, to BED.</span></a>
<a class="sourceLine" id="cb13-19" title="19">time_write_snpStats &lt;-<span class="st"> </span><span class="kw">system.time</span>({</a>
<a class="sourceLine" id="cb13-20" title="20">    <span class="co"># Transpose and convert our genotypes to SnpMatrix object.</span></a>
<a class="sourceLine" id="cb13-21" title="21">    <span class="co"># We flip 0s and 2s before converting</span></a>
<a class="sourceLine" id="cb13-22" title="22">    X_snpStats &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="kw">t</span>(X_snpStats), <span class="st">&#39;SnpMatrix&#39;</span>)</a>
<a class="sourceLine" id="cb13-23" title="23">    </a>
<a class="sourceLine" id="cb13-24" title="24">    <span class="co"># This complicated command is required to write the data.</span></a>
<a class="sourceLine" id="cb13-25" title="25">    <span class="co"># Although X, fam, and bim are passed as for genio&#39;s write_plink,</span></a>
<a class="sourceLine" id="cb13-26" title="26">    <span class="co"># here the name of every column must be specified (there are no reasonable defaults).</span></a>
<a class="sourceLine" id="cb13-27" title="27">    <span class="co"># Interestingly, the parameter names of snpStats&#39; write.plink</span></a>
<a class="sourceLine" id="cb13-28" title="28">    <span class="co"># do not agree with read.plink from the same package.</span></a>
<a class="sourceLine" id="cb13-29" title="29">    <span class="kw">write.plink</span>(</a>
<a class="sourceLine" id="cb13-30" title="30">        file_plink_copy,</a>
<a class="sourceLine" id="cb13-31" title="31">        <span class="dt">snps =</span> X_snpStats,</a>
<a class="sourceLine" id="cb13-32" title="32">        <span class="dt">subject.data =</span> fam_snpStats,</a>
<a class="sourceLine" id="cb13-33" title="33">        <span class="dt">pedigree =</span> fam,</a>
<a class="sourceLine" id="cb13-34" title="34">        <span class="dt">id =</span> id,</a>
<a class="sourceLine" id="cb13-35" title="35">        <span class="dt">father =</span> pat,</a>
<a class="sourceLine" id="cb13-36" title="36">        <span class="dt">mother =</span> mat,</a>
<a class="sourceLine" id="cb13-37" title="37">        <span class="dt">sex =</span> sex,</a>
<a class="sourceLine" id="cb13-38" title="38">        <span class="dt">phenotype =</span> pheno,</a>
<a class="sourceLine" id="cb13-39" title="39">        <span class="dt">snp.data =</span> bim_snpStats,</a>
<a class="sourceLine" id="cb13-40" title="40">        <span class="dt">chromosome =</span> chr,</a>
<a class="sourceLine" id="cb13-41" title="41">        <span class="dt">genetic.distance =</span> posg,</a>
<a class="sourceLine" id="cb13-42" title="42">        <span class="dt">position =</span> pos,</a>
<a class="sourceLine" id="cb13-43" title="43">        <span class="dt">allele.1 =</span> ref,</a>
<a class="sourceLine" id="cb13-44" title="44">        <span class="dt">allele.2 =</span> alt</a>
<a class="sourceLine" id="cb13-45" title="45">    )</a>
<a class="sourceLine" id="cb13-46" title="46">})</a>
<a class="sourceLine" id="cb13-47" title="47"><span class="co">#&gt; Writing FAM file to /tmp/Rtmp6m33wC/vignette-random-data-copy750038649398.fam </span></a>
<a class="sourceLine" id="cb13-48" title="48"><span class="co">#&gt; Writing extended MAP file to /tmp/Rtmp6m33wC/vignette-random-data-copy750038649398.bim </span></a>
<a class="sourceLine" id="cb13-49" title="49"><span class="co">#&gt; Writing BED file to /tmp/Rtmp6m33wC/vignette-random-data-copy750038649398.bed (SNP-major mode)</span></a>
<a class="sourceLine" id="cb13-50" title="50"></a>
<a class="sourceLine" id="cb13-51" title="51"><span class="co"># remove the new file, no longer need it</span></a>
<a class="sourceLine" id="cb13-52" title="52"><span class="kw">delete_files_plink</span>(file_plink_copy)</a></code></pre></div>
</div>
<div id="lfa" class="section level2">
<h2>LFA</h2>
<p>The <code>lfa</code> package also provides a minimal BED parser, ignoring the BIM and FAM files except to count loci and individuals. Its genotype matrix is exactly like <code>genio</code>’s: same class (R matrix) and orientation (loci along rows). The package does not provide file writers or other such utilities.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(lfa)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co"># Parse the genotype matrix</span></a>
<a class="sourceLine" id="cb14-3" title="3">time_read_lfa &lt;-<span class="st"> </span><span class="kw">system.time</span>(</a>
<a class="sourceLine" id="cb14-4" title="4">    X_lfa &lt;-<span class="st"> </span><span class="kw">read.bed</span>(file_plink)</a>
<a class="sourceLine" id="cb14-5" title="5">)</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">#&gt; [1] &quot;reading in 1001 individuals&quot;</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt; [1] &quot;reading in 10001 snps&quot;</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt; [1] &quot;snp major mode&quot;</span></a>
<a class="sourceLine" id="cb14-9" title="9">time_read_lfa</a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">#&gt;   0.195   0.065   0.260</span></a>
<a class="sourceLine" id="cb14-12" title="12"></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co"># This genotype matrix does not have column or row names:</span></a>
<a class="sourceLine" id="cb14-14" title="14">X_lfa[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt;  [1,]    0    2    1    2    1    2    2    0    1     1</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt;  [2,]   NA    1    2    2    1    2   NA    2   NA     2</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">#&gt;  [3,]    2   NA    2    1    1   NA    1    1    1     2</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="co">#&gt;  [4,]    0    2   NA    1    2    2    1    1   NA     0</span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="co">#&gt;  [5,]   NA    0    1    2    2    1    1    1   NA     2</span></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="co">#&gt;  [6,]    2    2    0    1    1    1    2    0    0     1</span></a>
<a class="sourceLine" id="cb14-22" title="22"><span class="co">#&gt;  [7,]    1   NA    1    1   NA    2    2    2    1     2</span></a>
<a class="sourceLine" id="cb14-23" title="23"><span class="co">#&gt;  [8,]    1    0   NA    2    0    0    0    1    1     0</span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="co">#&gt;  [9,]    1   NA    0    1    1    1   NA   NA   NA     2</span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="co">#&gt; [10,]    1    1    1    1    2    1    1    2    1     1</span></a>
<a class="sourceLine" id="cb14-26" title="26"></a>
<a class="sourceLine" id="cb14-27" title="27"><span class="co"># Again verify that the matrices are identical</span></a>
<a class="sourceLine" id="cb14-28" title="28"><span class="kw">stopifnot</span>( <span class="kw">all</span>( X <span class="op">==</span><span class="st"> </span>X_lfa, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) )</a></code></pre></div>
</div>
<div id="overall-time-comparisons" class="section level2">
<h2>Overall time comparisons</h2>
<p>Note that reading performance varies on different machines depending on the balance between hard drive access and processor speeds (where the relative bottleneck is). That being said, the <code>genio</code> reader is consistently the fastest, if not a close second (see below for tests on your machine), for several reasons. Genotypes are read very efficiently using <code>Rcpp</code> code, and stored directly into an R matrix, which is most efficient if that is the end goal. The annotation tables are also read most efficiently, using the <code>readr</code> package internally.</p>
<p>The <code>BEDMatrix</code> reader is also written in <code>Rcpp</code>, but its main goal is to provide efficient random access to genotypes stored in a file, which makes obtaining an <code>R</code> matrix more awkward, though surprisingly without paying a time penalty for it. The annotation tables are read with <code>data.table</code>, which is <a href="https://csgillespie.github.io/efficientR/5-3-importing-data.html">actually the fastest</a>, though the difference in performance is small compared to <code>readr</code> for reasonably-sized files. However, <code>BEDMatrix</code> does not process or return full annotation tables, which gives it an unfair advantage compared to <code>genio</code>, as <code>BEDMatrix</code> takes shortcuts to only read the columns it needs. If the annotation tables are needed, reading them will incur an additional (and in some cases considerable) time penalty.</p>
<p>The <code>snpStats</code> reader is written in <code>C</code>, so it is also very fast for its initial step, but converting the genotypes from the <code>snpStats</code> format into a native R matrix proves too expensive. The annotation tables are read with the base function <code>read.table</code>, which is also the slowest. In terms of completeness of output (full genotypes and annotations tables), only this package matches <code>genio</code>, which makes it the fairest comparison.</p>
<p>The <code>lfa</code> reader is written in pure <code>R</code>, which explains why it is the slowest in this comparison. The annotation tables are read with <code>read.table</code>, as in <code>snpStats</code>, but are not returned at all.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Extract component 3 of each time object,</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># which is is total time elapsed.</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># Sum the two steps it takes for each of BEDMatrix and snpStats to obtain a native R matrix.</span></a>
<a class="sourceLine" id="cb15-4" title="4">times_read &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb15-5" title="5">    time_read_genio[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb15-6" title="6">    time_read_bedmatrix_<span class="dv">1</span>[<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>time_read_bedmatrix_<span class="dv">2</span>[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb15-7" title="7">    time_read_snpStats_<span class="dv">1</span>[<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>time_read_snpStats_<span class="dv">2</span>[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb15-8" title="8">    time_read_lfa[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb15-9" title="9">)</a>
<a class="sourceLine" id="cb15-10" title="10">names_read &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb15-11" title="11">    <span class="st">&#39;genio&#39;</span>,</a>
<a class="sourceLine" id="cb15-12" title="12">    <span class="st">&#39;BEDMatrix&#39;</span>,</a>
<a class="sourceLine" id="cb15-13" title="13">    <span class="st">&#39;snpStats&#39;</span>,</a>
<a class="sourceLine" id="cb15-14" title="14">    <span class="st">&#39;lfa&#39;</span></a>
<a class="sourceLine" id="cb15-15" title="15">)</a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co"># Create barplot</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="kw">barplot</span>(</a>
<a class="sourceLine" id="cb15-18" title="18">    times_read,</a>
<a class="sourceLine" id="cb15-19" title="19">    <span class="dt">names.arg =</span> names_read,</a>
<a class="sourceLine" id="cb15-20" title="20">    <span class="dt">main =</span> <span class="st">&#39;BED reader runtimes&#39;</span>,</a>
<a class="sourceLine" id="cb15-21" title="21">    <span class="dt">xlab =</span> <span class="st">&#39;packages&#39;</span>,</a>
<a class="sourceLine" id="cb15-22" title="22">    <span class="dt">ylab =</span> <span class="st">&#39;runtime (s)&#39;</span></a>
<a class="sourceLine" id="cb15-23" title="23">)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Now we compare the writers. Only <code>snpStats</code> and <code>genio</code> have a BED writer. Not only was the <code>genio</code> writer much easier to use, it is also considerably faster.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">times_write &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb16-2" title="2">    time_write_genio[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb16-3" title="3">    time_write_snpStats[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb16-4" title="4">)</a>
<a class="sourceLine" id="cb16-5" title="5">names_write &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb16-6" title="6">    <span class="st">&#39;genio&#39;</span>,</a>
<a class="sourceLine" id="cb16-7" title="7">    <span class="st">&#39;snpStats&#39;</span></a>
<a class="sourceLine" id="cb16-8" title="8">)</a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co"># Create barplot</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="kw">barplot</span>(</a>
<a class="sourceLine" id="cb16-11" title="11">    times_write,</a>
<a class="sourceLine" id="cb16-12" title="12">    <span class="dt">names.arg =</span> names_write,</a>
<a class="sourceLine" id="cb16-13" title="13">    <span class="dt">main =</span> <span class="st">&#39;BED writer runtimes&#39;</span>,</a>
<a class="sourceLine" id="cb16-14" title="14">    <span class="dt">xlab =</span> <span class="st">&#39;packages&#39;</span>,</a>
<a class="sourceLine" id="cb16-15" title="15">    <span class="dt">ylab =</span> <span class="st">&#39;runtime (s)&#39;</span></a>
<a class="sourceLine" id="cb16-16" title="16">)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAGACAMAAACTGUWNAAAC/VBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///9tj94GAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASJklEQVR4nO2deXwUZZrHn5CDdA7uI0KASQwMt3IojTODjggSBc3IoqhxEBwcFXYHRxSC4rWZ9UIUIgYJh6iACAzIEWYYAYfDYWAFxOWawCjuAoMB5JAk5Hg/W0dXdXfSnfSbqsqT4/f9o7qq3qPqfb/peqsr/bxNArBC3CfQ0IEAZiCAGQhgBgKYgQBmIIAZCGAGApiBAGYggBkIYAYCmIEAZiCAGQhgBgKYgQBmIIAZCGAGApiBAGYggBkIYAYCmIEAZiCAGQhgBgKYgQBmIIAZPgFvk0bbn69WtzLJIF2IqdpK65sePVxFHcMoWogdkyYdqu5J6GW1aphgF6DwqggoQCFmS+V1aD2XTbSxuiehl22wAkZmZ88aHU3hJzUB6dkan2kCxma/+2xvom4lldaxPnueHQK0aphgFTBDfX2OaJUmIMdMUgR8qLwUDiVaoO8ZSK5iURhJ7YXYT/Q70Z8SLz3U5LT6p/vvSURdHxHi6OiUuL5ZxUpmT6JW0LOeSP2VjXXaQZRd3z+Q2PruPGGU1d4BKXT92pSYfq+XLRkY13WOWtZbo1g/OCGu15TvHegGfgHTiQ4GFiB2Eg3T9yiZvhR/Vy5Kp8R8orVqJ95NpAm4Tb1WucVncdpFa0SJMBK1gp51fwHNu6tZkwqMsh4BMY3UzSFh6nKJ8K1xoX5F7PyD/d3AKmBUTs6ch1x0r9AEjMnRuOIVIKLpWj3z50TvijlKH6wTj1HERaUTw6n/8HPeMaC4K3Xd9c8JRFnCSNQKetb9BVCXuQt+QrTabwxIIRr8wYPKIW794AGl2/1q7EgJG3dlEL1hfzfUgkH4plLhOwif9hGQTOFXtZWiWHpYjKNO9JLSfz/XOlG9bHsF5BKtFKIkgQaZiRqedX8BYf8UYpn2BvQTEHNRXG1GrguisAn18q2xgKj3UeVtOHW5/d1QCwTQuLJgAq41BIhU6iZ60x9oRFEUvah2YmOlkI+At5Q+crvd8dTGTNTwrPsLSFDWletZZjkB3YS67Kosf0I9/WrsrJxXj6c3V35HUD3Yx4AzE4neCzIGCJdxCRJvUtipiGbHqd1uou1qJ7ZX93oFTDYFXjQSNTzr5QZhZX1PRQE9hbFUBfjWePgebWBI3mt/N7ALEJeJUoMI2GUOwuq9z8s0RLSi6RRfbHSijwCltj1GcU+i73oi9VOWa2UE+NYoxPG3bg4nGmB/N/ALOELqKBxIQFEq0VueXWVtqD09K26ndsr4WEFArtigX+tzZuQEFJBM1ygjzSuBBOQGEeBT4/4ZM5R71u+SqZn93cB9FzTvlRT1BsfnLmi+JuCRnHkv9iW6xrzxu1+5BKwR05TlLOEvYB7RS5eKU6jT1mNK8rMBBQxRalz1gquCAK1sYAE+NW4nGrTh4LIWdLP93VAbBuFBJb6DcITPowjXX8zsyu0/nRSrSPvU4Cdgm3Yvv8GllfjljwEFfKIlDqwgYJvv5wB/AT41lgzXTydyu/3dwC6gxfWvKXf+gQS0dI8/6M3+LVEHIU4QtVO3fAWI59rEKBexA7/qFN93dqEIKEDM7xnbd2bFMUAvG1iAT40FWe6EqE73+IwJtoHH0cxAADMQwAwEMAMBzEAAMxDADAQwAwHMQAAzEMAMBDADAcxAADMQwAwEMAMBzEAAMxDADAQwAwHMQAAzEMAMBDADAcxAADMQwAwEMAMBzEAAMxDADAQwU78F5N/Ur0YZsFP6FOu3gCNtsmsU9/vSp1jPBSRurlGGQoA/EMAMBDADAcxAADMQwAwEMAMBzEAAMxDADAQwAwHMNBQB55cbZF2yoz7baCgC9o4yaJlrR3220VAEeHF/YW99FoEAZiCAGQhgBgKYgQBmIIAZCGAGApiBAGYggBkIYAYCmIEAZiCAmXoq4PzR0mBJECCLnIAPBn4lTg8nin87SAYIkEVKwCz6xWkxtP27uZMjFgfOAQGySAlIyhDiFP1VWZvaJ3AOCJBFSkDLlUIcoMvK2ob4wDkgQBYpAWl3FIniePWnpTKC/KYcBMgiJeBQm56vb8lst2BLRuTSwDkgQBa5u6Cjj7fQfuKrx8dBMkCALLKfA64e/2L9zuNBkyFAlmp+Ei68HHg/BMhSTQGj/coV7jHoJR8q7iT1V8Dc3/hu7TBj9eM+rV59DlF/BQQDlyBZ5AVcOldJIgTIIifgxLQusUSNU6YGuw+CAFmkBHwZ0+HxWR8snj0xufm+wDkgQBYpAbekXtFXiu+/LXAOCJBFSkCTFcbatiA/bw8BskgJ6P+EsfYSHsZxCFgRljp/56HDf1t8T/iKwDkgQBa5u6B1v9SexYXduiFIBgiQRfZzwLmvN2366mzQZAiQBZ+EIcBBIIAZCGAGApiBAGYggBkIYAYCmIEAZiCAGQhgBgKYqWMCSs+VWG0xBMhiCCheOS45gsI7pi8pstJiCJBFF1CalfjTx+bn7vzToom92r5eLFtJ2TmDGyBAEl3AwLG7zT0HnuhfIFnJluYGkaulz8BJ6oyAQ377jlf/KoRLkCz+d0GHc4P/tzEkIEAWU8CJIZPFynBqFeQrbyECAbKYAtLarRbX3X58yHBLLYYAWUwBLd4TJ2mTWNLaUoshQBZTQLNlYkF0gVgbZ6nFECCLKWDo4B297hZnUvtbajEEyGIK2NeWmnwpOkettdRiCJDFext6ZY9yC7r8qLUWQ4AsuoAc36dwpR/9WO0WQ4AsuoCnus885dmRn9X7MemHQSYQIIvnErT3vqjuYzJemTaud+Tdf7PQYgiQxRwDTi0ac0uvQenzvrPUYgiQBf8RgwAHgQBm6quA1WeCpUCALNUSQH8JlgIBsvgKKMyrIvOqdB0anJ4eOAcEyOIV8E6HMBKDZ1eWeX0M9XMrUDe3O3AOCJDFFDA/bPxiEtPD5laW+3C/G48IXIIcEdD9SZGvbDzds9LsV6fEvQsBjgiI2aAJ2BBbRYGtHVJPQYADAvq+oAl4uXdVJc7f1woCHBCwMDLzCzozP2pm1WWWTjoSLAkCZPHeBc1S52RtPLUspGKYttJ+AeLyro83fx9iMf9pKzebX02MwFcTJfF25KUD+zRCKuY/baU4b3w590a8AyQxBXwUTTqWWoxLkCxmf3cctO6wRlUlMG2lMwKa7gghN6atdE7AncF+l8cHTFvpoICTiZOWrlCpJDOmrXRQwJywqgdhTFvpoICk+w+XaFSSGdNWOijAFULXYdpKBwW4XwwhN6atdE7AzKhRr81QqTw/pq10SkCigaUWQ4As+F4QBDhInRGQs0nkGFhqMQTIoguIGy2aGVhqMQTIYl6CftD/FVZywVKLIUAWUwCd1l52N7HUYgiQRRewOy2NhqWp9Eiy1GIIkEUXsDc9nUZqX/scu8VSiyFAFu+jCIvzpHhqgQBJ8Dmgtgg4O+Fnbg1LLYYAWUwBI11jJmtYajEEyGIKaLLIjhZDgCyGgKu0zY4WQ4As5jtgeJCgo1DYlpLswbWm+rU4QF0SsLB1n4w3qv6HTECuHjPog3eAJPiHTG0RYA8QIAsE1BYBww0stRgCZDEFPKyS1ib8KUsthgBZyl2CLg8N8qXPEIEAWcqPAVsp6EQcoQABspQXsN4VWpReECBAFlPAhxqzO91iqcUQIIspIFojxn2ostxVAgGymA/jvpH92YyAQIAshoDC5ivtaDEEyGJegqamWRp9PUCALKaAT35x3ZSZbytYajEEyGIKSDCw1GIIkEXyYVzJcX2sLjgdOB0CZJESUDzdRa5n1DC+RUHKQYAsUgJej/j9iicjxgoIYBLQJUNZfEhrIIBJQOx6dZmedAUCeATc8Ht1+a82D0IAj4BMenxloRDrw9OnQACHgJKMJqROb7y2XbApJSBAFsnPAUXHCtWX4s+yA6dDgCzV/FYEZk1kFuA/a+Ke2wyaWfsdOLupvwL8Z028uMmg2/bq1ecQ9VdAMHAJkkVeAGZNZBSAWRN5BWDWRGYBmDWRWQBmTWQWgFkTmQVg1kRmAZg1kVsAZk1kF1AFECALBECAg0AAMw1ZwEO31ShDAn65uyELcP3XGzXJiIDRnQ1aQG6NNv0xCNCAAFkgwE4goBwQUGNAgA4EyAIBdgIB5YCAGqNhCzj4qEHbjcY+CAgNWwScmmuQvNXYBwGhgUuQnUBAOSCgxoAAHQiQBQLsBALKAQE1BgToQIAsEGAnEFAOCKgxIEAHAmSBADuBgHJAQI3RgASEGKgNAaHhWKA2BISGY4HaEBAajgVqQ0BoOBaoDQGh4VigNgSEhmOB2hAQGo4FakNAaDgWqA0BoeHYrIkQEBq2zJr47asGHT8z9rnGja9J3IEFNK3RkxjfmWnWxLwpBmnfGPtmTKlZAk7XeOW5Gj6LY9I9afPDOCCLzQ/jgCw2P4wDstj8MA7IYvPDOCCLzQ/jgCw2P4wDstj8MA7IYvPDOCCLzQ/jgCz4JMwMBDADAcxAADMQwAwEMAMBzEAAMxDADAQwAwHMQAAzEMAMBDBTawXE5bAdeufw9tEpT11Q1vbu9tntt2EbtVbA6E1cR/48InXpulcTrisQIj3NZ7/fhm3UQgHFXAcsK9FeUm8oU5b7aEUDEFA6rVPHjElqwxb1i+25QHlNXDiCmo46K0Qz5RJUmtk93u3Qj6TvH9a85a9OeA+YR7kdw7q9pqR0GallyNgk3ET0w8XfpUQn/6fQN4xS9sEr4D+aZX9yfWNFwOzI5zdMCpuj9EfrB/+6IHqCLmBC9CvrxtIaJ458pe2tS+e2G+I9YB65xq9+KuwFIX7d6PH/0TOdHTnsdNk9CTM+fabRUm3jR6OUfbAKOBm1RIj/i0gTl1tmKpvjOyj9cb3y/h/zM03AdxGzlb139nHi0HtohxCrJ3sPmEfqH/7T8RfFuXsjqOPYj4uEftUZuVRZue4ZbcMsZR+sAtbQJWV5Y5rYRV/k5+cvDisUiRnKnsluTcCn9C9l4/1GRQ4cOj++18KT6opxwDz1mi8O0C5lef6PE5Mo6Yhx2S/5OitysrZhlrIPVgFZLnU5PE18TDr/EIlvCFNAdiN1NNxE3zpx7P8eEU19VgnzgHmkRhicVzRoQ3HpiiapuoDtA1zXPtheF2CWsg9WAStIjXRyp4nNdMazK3GG8HkHqHs/DCtw5uhX/nx7+BHzgPo74CDt+Jo+15If7qD1+bnI8UeVc5xsvB30UvbBKuB4+DIhTkWliTON5yub0wf7C/g2IkvZuKu3E4de3lmRe5xyfQTcq6xMizlf2PLeUmWtqPtdWp//mfKEKLhGF2CWsg/eu6DftlywZkB7peVTojI3PB02y1+AeML15sZHabUTRz4adce6pUNbnfURED1hfUajaUIspIFvLstyx+wXYmyPPcciR21bMyD2jnx145BRyj54BVx9sm3Xj25XbjrLZvSM6ZYtygkoeblb3ACHPges7Rfb6o59wkfAH+9s1uUP6qjzp3/rEp38wFfK2pak+AvLusTeuPb95s9rG0Yp+2AVcClbGV/Lkl7lPAeDPNrDclxWAWUd7sw793KUzTd21aNBChBf9qGwLhurzlcDNEwBQly4xHwCBsXfOPF5r2q4BTR4IIAZCGAGApiBAGYggBkIYAYCmIEAZiCAGQhgBgKYgQBmIIAZCGAGApiBAGYggBkIYAYCmIEAZiCAmfokIJ+2cp+CPBDATJ0U4AlnLA8E1AjecEYjflGUPP/T5kO/1gSU3pfwD29CxShM+8McLVIXBRjhjEb8onik6Tvrh8WdUAX8tvl+n4QKUZhX7A9ztEhdFGCEMxrxi0cbLRfix7hZioCpsTuFN7CxYhSmA2GOFqmLArzhjHr84uIINdb9YkE+3UU99OFBT6gYhelAmKNF6qIAI5zRiF/MTNBT8sn1Gr0jvIGNAaIw7Q9ztEhdFOAJZzTjF3Oi1Ki6vUfyaZG4r8VZb2BjgChM+8McLVIXBXjCGc34xX20Vllp+aY6CJ9wTfQGNlaMwnQgzNEidVGAJ5zxGzN+cVTL9zbd1fR/tc8BL4Yf8CZUiMI8an+Yo0XqogAjnNGMXyyafG38zX/XP4hd6XirN6FiFKb9YY4WqYsCQg7mqk1RmMGo1wJqUxRmMOq1gNoUhRmMuidALpyx1kRhBqPuCahnQAAzEMAMBDADAcxAADMQwAwEMAMBzEAAMxDADAQwAwHMQAAzEMAMBDADAcxAADMQwAwEMAMBzPw/PhSlUL428CEAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
</div>
<div id="memory-comparison" class="section level2">
<h2>Memory comparison</h2>
<p>High memory consumption is the main sacrifice for the ease of use of native R matrices, and in this respect <code>genio</code> consumes the most memory (second only to <code>lfa</code>).</p>
<p>We use the <code>pryr</code> package to compare the memory usage of each native genotype object.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(pryr)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># Store directly into a vector</span></a>
<a class="sourceLine" id="cb17-3" title="3">sizes &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb17-4" title="4">    <span class="kw">object_size</span>( X ),</a>
<a class="sourceLine" id="cb17-5" title="5">    <span class="kw">object_size</span>( data_genio<span class="op">$</span>X ),</a>
<a class="sourceLine" id="cb17-6" title="6">    <span class="kw">object_size</span>( X_BEDMatrix ),</a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="kw">object_size</span>( data_snpStats<span class="op">$</span>genotypes ),</a>
<a class="sourceLine" id="cb17-8" title="8">    <span class="kw">object_size</span>( X_lfa )</a>
<a class="sourceLine" id="cb17-9" title="9">)</a>
<a class="sourceLine" id="cb17-10" title="10">names_sizes &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb17-11" title="11">    <span class="st">&#39;original&#39;</span>,</a>
<a class="sourceLine" id="cb17-12" title="12">    <span class="st">&#39;genio&#39;</span>,</a>
<a class="sourceLine" id="cb17-13" title="13">    <span class="st">&#39;BEDMatrix&#39;</span>,</a>
<a class="sourceLine" id="cb17-14" title="14">    <span class="st">&#39;snpStats&#39;</span>,</a>
<a class="sourceLine" id="cb17-15" title="15">    <span class="st">&#39;lfa&#39;</span></a>
<a class="sourceLine" id="cb17-16" title="16">)</a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co"># Create barplot</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="kw">barplot</span>(</a>
<a class="sourceLine" id="cb17-19" title="19">    sizes,</a>
<a class="sourceLine" id="cb17-20" title="20">    <span class="dt">names.arg =</span> names_sizes,</a>
<a class="sourceLine" id="cb17-21" title="21">    <span class="dt">main =</span> <span class="st">&#39;Native genotype object sizes&#39;</span>,</a>
<a class="sourceLine" id="cb17-22" title="22">    <span class="dt">xlab =</span> <span class="st">&#39;packages&#39;</span>,</a>
<a class="sourceLine" id="cb17-23" title="23">    <span class="dt">ylab =</span> <span class="st">&#39;memory (bytes)&#39;</span></a>
<a class="sourceLine" id="cb17-24" title="24">)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The <code>BEDMatrix</code> package is ideal for very large files, since data is loaded into memory only as needed. So the main object does not actually hold any genotypes in memory. It is up to the user to decide how much data to access at once to trade-off speed and memory consumption.</p>
<p><code>snpStats</code> manages memory better than <code>genio</code>, but strictly by a factor of 4. Each genotype is encoded as an integer in <code>R</code> (in general) and <code>genio</code> (in particular), which uses 4 bytes (this is actually platform dependent). On the other hand, <code>snpStats</code> uses strictly one byte per genotype.</p>
<p><code>lfa</code> uses 8 bytes per genotype because its genotype matrix treats is elements as doubles rather than integers, so it uses twice as much memory as <code>genio</code>.</p>
<p>Overall, there is a narrow window in data sizes in which a genotype matrix is too large for a native R matrix but small enough for a <code>snpStats</code> object. That, and the much more complex interface of <code>snpStats</code>, makes it not very worthwhile in my opinion, unless there is need for functions provided only by that package. I prefer to use <code>BEDMatrix</code> for large datasets.</p>
</div>
</div>
<div id="cleanup" class="section level1">
<h1>Cleanup</h1>
<p>This handy function removes the three BED/BIM/FAM files we generated at the beginning of this vignette.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">delete_files_plink</span>(file_plink)</a></code></pre></div>
<p>Let’s close by showing the package versions used when this vignette was last built, as the implementations compared here could change in the future.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">sessionInfo</span>()</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt; R version 3.5.3 (2019-03-11)</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt; Platform: x86_64-redhat-linux-gnu (64-bit)</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#&gt; Running under: Fedora 30 (Workstation Edition)</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">#&gt; Matrix products: default</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">#&gt; BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co">#&gt; locale:</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C              </span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co">#&gt; attached base packages:</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-20" title="20"><span class="co">#&gt; other attached packages:</span></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="co">#&gt; [1] pryr_0.1.4      lfa_1.12.0      snpStats_1.32.0 Matrix_1.2-15  </span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="co">#&gt; [5] survival_2.43-3 BEDMatrix_1.5.0 genio_1.0.10   </span></a>
<a class="sourceLine" id="cb19-23" title="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-24" title="24"><span class="co">#&gt; loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb19-25" title="25"><span class="co">#&gt;  [1] Rcpp_1.0.1          compiler_3.5.3      pillar_1.4.1       </span></a>
<a class="sourceLine" id="cb19-26" title="26"><span class="co">#&gt;  [4] tools_3.5.3         zlibbioc_1.28.0     crochet_2.1.0      </span></a>
<a class="sourceLine" id="cb19-27" title="27"><span class="co">#&gt;  [7] zeallot_0.1.0       digest_0.6.19       evaluate_0.13      </span></a>
<a class="sourceLine" id="cb19-28" title="28"><span class="co">#&gt; [10] tibble_2.1.1        lattice_0.20-38     pkgconfig_2.0.2    </span></a>
<a class="sourceLine" id="cb19-29" title="29"><span class="co">#&gt; [13] rlang_0.3.4         cli_1.1.0           yaml_2.2.0         </span></a>
<a class="sourceLine" id="cb19-30" title="30"><span class="co">#&gt; [16] parallel_3.5.3      xfun_0.7            stringr_1.4.0      </span></a>
<a class="sourceLine" id="cb19-31" title="31"><span class="co">#&gt; [19] knitr_1.23          hms_0.4.2           vctrs_0.1.0        </span></a>
<a class="sourceLine" id="cb19-32" title="32"><span class="co">#&gt; [22] grid_3.5.3          R6_2.4.0            fansi_0.4.0        </span></a>
<a class="sourceLine" id="cb19-33" title="33"><span class="co">#&gt; [25] rmarkdown_1.13      readr_1.3.1         corpcor_1.6.9      </span></a>
<a class="sourceLine" id="cb19-34" title="34"><span class="co">#&gt; [28] magrittr_1.5        backports_1.1.4     codetools_0.2-16   </span></a>
<a class="sourceLine" id="cb19-35" title="35"><span class="co">#&gt; [31] htmltools_0.3.6     splines_3.5.3       BiocGenerics_0.28.0</span></a>
<a class="sourceLine" id="cb19-36" title="36"><span class="co">#&gt; [34] assertthat_0.2.1    utf8_1.1.4          stringi_1.4.3      </span></a>
<a class="sourceLine" id="cb19-37" title="37"><span class="co">#&gt; [37] crayon_1.3.4</span></a></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
